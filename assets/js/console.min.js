jQuery(document).ready(function(e){var s=e("#giapi-response"),a=e("#giapi-submit"),i=e("#giapi-url"),r=e(".giapi-action"),t=e("#giapi-response-userfriendly");e("#giapi-response-trigger").click(function(s){s.preventDefault(),e(this).find(".dashicons").toggleClass("dashicons-arrow-down-alt2 dashicons-arrow-up-alt2"),e("#giapi-response-wrapper").toggle()}),e("#instant-indexing").submit(function(n){n.preventDefault(),a.attr("disabled","disabled");var o=i.val(),l=r.filter(":checked").val(),d=e("#_wpnonce").val();e.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"rm_giapi",url:o,api_action:l,_wpnonce:d}}).always(function(n){!function(a,n,o){var l=(m=new Date).toLocaleTimeString(),d=i.val().split("\n").filter(Boolean),p=d[0],g=!1,c=r.filter(":checked").val();if(d.length>1&&(p="(batch)",g=!0),t.removeClass("not-ready fail success").addClass("ready").find(".response-id").html("<strong>"+c+"</strong> "+p),"bing_submit"!==o)if(g)t.addClass("success").find(".response-status").text(rm_giapi.l10n_success+" ").siblings(".response-message").text(rm_giapi.l10n_see_response),void 0!==a.error?t.addClass("fail").find(".response-status").text(rm_giapi.l10n_error+" "+a.error.code).siblings(".response-message").text(a.error.message):e.each(a,function(e,s){if(void 0!==s.error){var a="";void 0!==s.error.code&&(a=s.error.code),void 0!==s.error.message&&s.error.message,t.addClass("fail").find(".response-status").text(rm_giapi.l10n_error+" "+a).siblings(".response-message").text(s.error.message)}});else if(void 0!==a.error)t.addClass("fail").find(".response-status").text(rm_giapi.l10n_error+" "+a.error.code).siblings(".response-message").text(a.error.message);else{var u=a;void 0!==a.urlNotificationMetadata&&(u=a.urlNotificationMetadata);var m=new Date(u.latestUpdate.notifyTime);t.addClass("success").find(".response-status").text(rm_giapi.l10n_success+" ").siblings(".response-message").text(rm_giapi.l10n_last_updated+" "+m.toString())}else void 0!==a.error?t.addClass("fail").find(".response-status").text(rm_giapi.l10n_error+" "+a.error.code).siblings(".response-message").text(a.error.message):t.addClass("success").find(".response-status").text(rm_giapi.l10n_success+" ").siblings(".response-message").text(rm_giapi.l10n_see_response);var f=l+" "+c+": "+p+"\n"+JSON.stringify(a,null,2)+"\n"+"-".repeat(56),_=s.val();s.val(f+"\n"+_)}(n,0,l),a.removeAttr("disabled"),e.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"rm_giapi_limits",_wpnonce:d}}).done(function(s){e.each(s,function(s,a){e("#giapi-limit-"+s).text(a)})})})}),rm_giapi.submit_onload&&e("#instant-indexing").submit()}),jQuery(window).on("load",function(){jQuery("#giapi-submit").prop("disabled",!1)});